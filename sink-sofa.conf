context.modules = [
    { name = libpipewire-module-filter-chain
        flags = [ nofail ]
        args = {
            node.description = "HRTF Surround"
            media.name       = "HRTF Surround"
            filter.graph = {
                nodes = [
                    # duplicate inputs
					
					{ type = builtin label = copy name = copy }
					{ type = builtin label = copy name = copyCL }
					{ type = builtin label = copy name = copyCR }
					{ type = builtin label = copy name = copyFLL  }
                    { type = builtin label = copy name = copyFRR  }
					{ type = builtin label = copy name = copyFLH  }
                    { type = builtin label = copy name = copyFRH  }
                    { type = builtin label = copy name = copyFL_MIDDLE  }
                    { type = builtin label = copy name = copyFR_MIDDLE  }
					{ type = builtin label = copy name = copyFL_LOW  }
                    { type = builtin label = copy name = copyFR_LOW  }
					{ type = builtin label = copy name = copyFL_HIGH  }
                    { type = builtin label = copy name = copyFR_HIGH  }

					{ type = builtin label = copy name = copyFL_RAW  }
                    { type = builtin label = copy name = copyFR_RAW  }

					{
                        type = ladspa
                        name = widthF 
                        plugin = matrix_spatialiser_1422
                        label = matrixSpatialiser
                        control = {
                            "Width" = 0
                        }
                    }

					{
                        type = ladspa
                        name = widthS
                        plugin = matrix_spatialiser_1422
                        label = matrixSpatialiser
                        control = {
                            "Width" = 0
                        }
                    }

					{
                        type = ladspa
                        name = widthR
                        plugin = matrix_spatialiser_1422
                        label = matrixSpatialiser
                        control = {
                            "Width" = 0
                        }
                    }


					{
						type = builtin
						name = delayRL
						label = delay  
						config = {
							"max-delay" = 0.00002
						}
						control = {
							"Delay (s)" = 0.00002
						}
					}

					{
						type = builtin
						name = delayRR
						label = delay  
						config = {
							"max-delay" = 0.00002
						}
						control = {
							"Delay (s)" = 0.00002
						}
					}

					{
						type = builtin
						name = delaySL
						label = delay  
						config = {
							"max-delay" = 0.00001
						}
						control = {
							"Delay (s)" = 0.00001
						}
					}

					{
						type = builtin
						name = delaySR
						label = delay  
						config = {
							"max-delay" = 0.00001
						}
						control = {
							"Delay (s)" = 0.00001
						}
					}

					{
						type = builtin
						name = delayLL
						label = delay  
						config = {
							"max-delay" = 0.000005
						}
						control = {
							"Delay (s)" = 0.000005
						}
					}

					{
						type = builtin
						name = delayLR
						label = delay  
						config = {
							"max-delay" = 0.000005
						}
						control = {
							"Delay (s)" = 0.000005
						}
					}

					{
						type = builtin
						name = delayML
						label = delay  
						config = {
							"max-delay" = 0.000003
						}
						control = {
							"Delay (s)" = 0.000003
						}
					}

					{
						type = builtin
						name = delayMR
						label = delay  
						config = {
							"max-delay" = 0.000003
						}
						control = {
							"Delay (s)" = 0.000003
						}
					}

					{
						type = builtin
						name = delayHL
						label = delay  
						config = {
							"max-delay" = 0.000005
						}
						control = {
							"Delay (s)" = 0.000000
						}
					}

					{
						type = builtin
						name = delayHR
						label = delay  
						config = {
							"max-delay" = 0.000005
						}
						control = {
							"Delay (s)" = 0.000000
						}
					}


					{
                        type  = builtin
                        name  = eq_lshL
                        label = bq_lowshelf
                        control = { "Freq" = 150.0, "Q" = 0.5 "Gain" = -10 }
                    }

					{
                        type  = builtin
                        name  = eq_lshR
                        label = bq_lowshelf
                        control = { "Freq" = 150.0, "Q" = 0.5 "Gain" = -10 }
                    }

					{
                        type  = builtin
                        name  = eq_subL
                        label = bq_highshelf
                        control = { "Freq" = 150.0, "Q" = 0.5 "Gain" = -10 }
                    }

					{
                        type  = builtin
                        name  = eq_subR
                        label = bq_highshelf
                        control = { "Freq" = 150.0, "Q" = 0.5 "Gain" = -10 }
                    }

					{
                        type  = builtin
                        name  = eq_frontL
                        label = bq_lowshelf
                        control = { "Freq" = 5000.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_frontR
                        label = bq_lowshelf
                        control = { "Freq" = 5000.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_rearL
                        label = bq_highshelf
                        control = { "Freq" = 800.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_rearR
                        label = bq_highshelf
                        control = { "Freq" = 800.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_sideL1
                        label = bq_highshelf
                        control = { "Freq" = 5000.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_sideR1
                        label = bq_highshelf
                        control = { "Freq" = 5000.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_sideL2
                        label = bq_lowshelf
                        control = { "Freq" = 800.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_sideR2
                        label = bq_lowshelf
                        control = { "Freq" = 800.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_highL
                        label = bq_lowshelf
                        control = { "Freq" = 10000.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_highR
                        label = bq_lowshelf
                        control = { "Freq" = 10000.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_lowL
                        label = bq_highshelf
                        control = { "Freq" = 300.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_lowR
                        label = bq_highshelf
                        control = { "Freq" = 300.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_middleL1
                        label = bq_highshelf
                        control = { "Freq" = 10000.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_middleR1
                        label = bq_highshelf
                        control = { "Freq" = 10000.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_middleL2
                        label = bq_lowshelf
                        control = { "Freq" = 300.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                        type  = builtin
                        name  = eq_middleR2
                        label = bq_lowshelf
                        control = { "Freq" = 300.0, "Q" = 0.7 "Gain" = -5 }
                    }

					{
                    	type	= sofa
                    	label	= spatializer
                    	name	= sof_subL
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 60
                    		"Elevation" = -5
							
                    	}
                    }

					{
                    	type	= sofa
                    	label	= spatializer
                    	name	= sof_subR
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 300
                    		"Elevation" = -5
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az30el0
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 30
                    		"Elevation" = 0
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az90el0
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 90
                    		"Elevation" = 0
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az150el0
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 150
                    		"Elevation" = 0
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az210el0
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 210
                    		"Elevation" = 0
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az270el0
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 270
                    		"Elevation" = 0
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az330el0
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 330
                    		"Elevation" = 0
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az30el30
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 30
                    		"Elevation" = 45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az90el30
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 90
                    		"Elevation" = 45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az150el30
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 150
                    		"Elevation" = 45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az210el30
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 210
                    		"Elevation" = 45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az270el30
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 270
                    		"Elevation" = 45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az330el30
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 330
                    		"Elevation" = 45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az30el30n
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 30
                    		"Elevation" = -45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az90el30n
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 90
                    		"Elevation" = -45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az150el30n
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 150
                    		"Elevation" = -45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az210el30n
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 210
                    		"Elevation" = -45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az270el30n
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 270
                    		"Elevation" = -45
							
                    	}
                    }

                    {
                    	type	= sofa
                    	label	= spatializer
                    	name	= az330el30n
                    	config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 330
                    		"Elevation" = -45
							
                    	}
                    }

					{
                    	type	= sofa
                    	label	= spatializer
                    	name	= sof_god
						config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 0
                    		"Elevation" = 90
							
                    	}
                    }

					{
                    	type	= sofa
                    	label	= spatializer
                    	name	= sof_devil
						config = {
                    		filename = "/.../hrtf.sofa"
                    	}
                    	control = {
                    		"Azimuth" = 180
                    		"Elevation" = -90
							
                    	}
                    }


                    # stereo output

                    { type = builtin label = mixer name = mixLa }
					{ type = builtin label = mixer name = mixLb }
					{ type = builtin label = mixer name = mixLc }
					{ type = builtin label = mixer name = mixL control = {
						"Gain 1" = 1
						"Gain 2" = 1
						"Gain 3" = 1
						"Gain 4" = 3
						"Gain 5" = 3
					}}
  
					{ type = builtin label = mixer name = mixRa }
					{ type = builtin label = mixer name = mixRb }
					{ type = builtin label = mixer name = mixRc }
                    { type = builtin label = mixer name = mixR control = {
                    	"Gain 1" = 1
						"Gain 2" = 1
						"Gain 3" = 1
						"Gain 4" = 3
						"Gain 5" = 3
					}}
                ]
                links = [
                    # input
					{ output = "copyFL_RAW:Out" input = "eq_subL:In" }
					{ output = "copyFR_RAW:Out" input = "eq_subR:In" }

					{ output = "eq_subL:Out" input = "sof_subL:In" }
					{ output = "eq_subR:Out" input = "sof_subR:In" }

					{ output = "copyFL_RAW:Out" input = "eq_lshL:In" }
					{ output = "copyFR_RAW:Out" input = "eq_lshR:In" }

					{ output = "eq_lshL:Out" input = "delayHL:In" }
					{ output = "eq_lshR:Out" input = "delayHR:In" }
					{ output = "delayHL:Out" input = "copyFL_HIGH:In" }
					{ output = "delayHR:Out" input = "copyFR_HIGH:In" }
					{ output = "eq_lshL:Out" input = "delayML:In" }
					{ output = "eq_lshR:Out" input = "delayMR:In" }
					{ output = "delayML:Out" input = "copyFL_MIDDLE:In" }
					{ output = "delayMR:Out" input = "copyFR_MIDDLE:In" }
					{ output = "eq_lshL:Out" input = "delayLL:In" }
					{ output = "eq_lshR:Out" input = "delayLR:In" }
					{ output = "delayLL:Out" input = "copyFL_LOW:In" }
					{ output = "delayLR:Out" input = "copyFR_LOW:In" }


                    { output = "copyFL_MIDDLE:Out"  input="az30el0:In"  }
                    { output = "copyFL_MIDDLE:Out"  input="az90el0:In"  }
                    { output = "copyFL_MIDDLE:Out"  input="az150el0:In"  }
                    
                    { output = "copyFL_HIGH:Out"  input="az30el30:In"  }
                    { output = "copyFL_HIGH:Out"  input="az90el30:In"  }
                    { output = "copyFL_HIGH:Out"  input="az150el30:In"  }
                    
                    { output = "copyFL_LOW:Out"  input="az30el30n:In"  }
                    { output = "copyFL_LOW:Out"  input="az90el30n:In"  }
                    { output = "copyFL_LOW:Out"  input="az150el30n:In"  }


                    { output = "copyFR_MIDDLE:Out"  input="az210el0:In"  }
                    { output = "copyFR_MIDDLE:Out"  input="az270el0:In"  }
                    { output = "copyFR_MIDDLE:Out"  input="az330el0:In"  }
    
                    { output = "copyFR_HIGH:Out"  input="az210el30:In"  }
                    { output = "copyFR_HIGH:Out"  input="az270el30:In"  }
                    { output = "copyFR_HIGH:Out"  input="az330el30:In"  }
        
                    { output = "copyFR_LOW:Out"  input="az210el30n:In"  }
                    { output = "copyFR_LOW:Out"  input="az270el30n:In"  }
                    { output = "copyFR_LOW:Out"  input="az330el30n:In"  }


                    # output

                    { output = "az30el0:Out L"  input="mixLa:In 1" }
                    { output = "az90el0:Out L"  input="mixLb:In 1" }
                    { output = "az150el0:Out L"  input="mixLc:In 1" }

                    { output = "az210el0:Out L"  input="mixLc:In 2" }
                    { output = "az270el0:Out L"  input="mixLb:In 2" }
                    { output = "az330el0:Out L"  input="mixLa:In 2" }

                    { output = "az30el30:Out L"  input="mixLa:In 3" }
                    { output = "az90el30:Out L"  input="mixLb:In 3" }
                    { output = "az150el30:Out L"  input="mixLc:In 3" }
                
                    { output = "az210el30:Out L"  input="mixLc:In 4" }
                    { output = "az270el30:Out L"  input="mixLb:In 4" }
                    { output = "az330el30:Out L"  input="mixLa:In 4" }
                
                    { output = "az30el30n:Out L"  input="mixLa:In 5" }
                    { output = "az90el30n:Out L"  input="mixLb:In 5" }
                    { output = "az150el30n:Out L"  input="mixLc:In 5" }
                
                    { output = "az210el30n:Out L"  input="mixLc:In 6" }
                    { output = "az270el30n:Out L"  input="mixLb:In 6" }
                    { output = "az330el30n:Out L"  input="mixLa:In 6" }

					{ output = "mixLb:Out" input = "eq_sideL1:In" }
					{ output = "mixLa:Out" input = "eq_frontL:In" }
					{ output = "mixLc:Out" input = "eq_rearL:In" }
					{ output = "eq_frontL:Out" input = "widthF:Input L" }
					{ output = "eq_sideL1:Out" input = "eq_sideL2:In" }
					{ output = "eq_sideL2:Out" input = "widthS:Input L" }
					{ output = "widthS:Output L" input = "delaySL:In" }
					{ output = "eq_rearL:Out" input = "widthR:Input L" }
					{ output = "widthR:Output L" input = "delayRL:In" }
					{ output = "delaySL:Out" input = "mixL:In 1" }
					{ output = "widthF:Output L" input = "mixL:In 2" }
					{ output = "delayRL:Out" input = "mixL:In 3" }
					{ output = "sof_subL:Out L" input = "mixL:In 4" }
					{ output = "sof_subR:Out L" input = "mixL:In 5" }
				

                    { output = "az30el0:Out R"  input="mixRa:In 1" }
                    { output = "az90el0:Out R"  input="mixRb:In 1" }
                    { output = "az150el0:Out R"  input="mixRc:In 1" }
                    
                    { output = "az210el0:Out R"  input="mixRc:In 2" }
                    { output = "az270el0:Out R"  input="mixRb:In 2" }
                    { output = "az330el0:Out R"  input="mixRa:In 2" }
                    
                    { output = "az30el30:Out R"  input="mixRa:In 3" }
                    { output = "az90el30:Out R"  input="mixRb:In 3" }
                    { output = "az150el30:Out R"  input="mixRc:In 3" }
                    
                    { output = "az210el30:Out R"  input="mixRc:In 4" }
                    { output = "az270el30:Out R"  input="mixRb:In 4" }
                    { output = "az330el30:Out R"  input="mixRa:In 4" }
                    
                    { output = "az30el30n:Out R"  input="mixRa:In 5" }
                    { output = "az90el30n:Out R"  input="mixRb:In 5" }
                    { output = "az150el30n:Out R"  input="mixRc:In 5" }
                    
                    { output = "az210el30n:Out R"  input="mixRc:In 6" }
                    { output = "az270el30n:Out R"  input="mixRb:In 6" }
                    { output = "az330el30n:Out R"  input="mixRa:In 6" }
                    
					{ output = "mixRb:Out" input = "eq_sideR1:In" }
					{ output = "mixRa:Out" input = "eq_frontR:In" }
					{ output = "mixRc:Out" input = "eq_rearR:In" }
					{ output = "eq_frontR:Out" input = "widthF:Input R" }
					{ output = "eq_sideR1:Out" input = "eq_sideR2:In" }
					{ output = "eq_sideR2:Out" input = "widthS:Input R" }
					{ output = "widthS:Output R" input = "delaySR:In" }
					{ output = "eq_rearR:Out" input = "widthR:Input R" }
					{ output = "widthR:Output R" input = "delayRR:In" }
					{ output = "delaySR:Out" input = "mixR:In 1" }
					{ output = "widthF:Output R" input = "mixR:In 2" }
					{ output = "delayRR:Out" input = "mixR:In 3" }
					{ output = "sof_subL:Out R" input = "mixR:In 4" }
					{ output = "sof_subR:Out R" input = "mixR:In 5" }
					
					
                ]
                inputs  = [ "copyFL_RAW:In" "copyFR_RAW:In" ]
                outputs = [ "mixL:Out" "mixR:Out" ]
            }
            capture.props = {
                node.name      = "effect_input.sofa"
                media.class    = Audio/Sink
                audio.channels = 2
                audio.position = [ FL FR ]
            }
            playback.props = {
                node.name      = "effect_output.sofa"
                node.passive   = true
                audio.channels = 2
                audio.position = [ FL FR ]
            }
        }
    }
]
